<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Schoah</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f2f2f2;
      text-align: center;
      padding: 50px;
      overflow: hidden; /* keep elements in viewport */
    }
    #logo {
      width: 200px;
      height: auto;
      margin-bottom: 20px;
    }
    #results {
      text-align: left;
      margin-top: 20px;
      max-width: 600px;
      margin: 20px auto;
      background: #fff;
      padding: 20px;
      border-radius: 8px;
    }
    .result {
      margin-bottom: 15px;
    }
    .result a {
      font-size: 18px;
      font-weight: bold;
      text-decoration: none;
      color: #1a0dab;
    }
    .result p {
      margin: 5px 0 0;
      color: #444;
    }
    .gravitized {
      position: absolute;
      cursor: grab;
    }
  </style>
</head>
<body>
  <img id="logo" src="./logo.png" alt="Schoah Logo">

  <input type="text" id="query" placeholder="Search DuckDuckGo...">
  <button onclick="search()">Search</button>
  <div id="results"></div>

  <script>
    function search() {
      var query = document.getElementById('query').value.trim().toLowerCase();
      var resultsDiv = document.getElementById('results');
      resultsDiv.innerHTML = '';

      if (query === 'gravity') {
        gravitize();
        return;
      }

      // Regular Nexus S Easter Egg
      if (query === 'nexus s') {
        var isShrimpo = Math.floor(Math.random() * 1000) === 0;
        var joke = "Why did the Nexus S laugh? Because the iPhone tried to keep up and tripped over its own overpriced dongle!";
        var message = joke;

        if (isShrimpo) {
          message = "WHY DID THE NEXUS S LAUGH? BECAUSE THE PATHETIC IPHONE TRIPPED OVER ITS STUPID DONGLE! HA!";
          document.body.style.background = "url('./heatphone.png') no-repeat center center";
          document.body.style.backgroundSize = "cover";
        }

        var egg = document.createElement('div');
        egg.className = 'easter-egg';
        egg.innerHTML = message;
        resultsDiv.appendChild(egg);

        setTimeout(function() {
          window.location.href = 'https://en.wikipedia.org/wiki/Nexus_S';
        }, 10000);
        return;
      }

      // Normal DuckDuckGo search
      var url = 'https://api.duckduckgo.com/?q=' + encodeURIComponent(query) + '&format=json&no_html=1';

      var xhr = new XMLHttpRequest();
      xhr.open('GET', url, true);

      xhr.onreadystatechange = function () {
        if (xhr.readyState === 4 && xhr.status === 200) {
          var data = JSON.parse(xhr.responseText);

          if (data.AbstractText) {
            var abstractDiv = document.createElement('div');
            abstractDiv.className = 'result';
            abstractDiv.innerHTML =
              '<h3>' + data.Heading + '</h3>' +
              '<p>' + data.AbstractText + '</p>' +
              '<a href="' + data.AbstractURL + '" target="_blank">' + data.AbstractURL + '</a>';
            resultsDiv.appendChild(abstractDiv);
          }

          if (data.RelatedTopics && data.RelatedTopics.length > 0) {
            var count = 0;
            for (var i = 0; i < data.RelatedTopics.length; i++) {
              var item = data.RelatedTopics[i];
              if (item.Topics && item.Topics.length > 0) {
                for (var j = 0; j < item.Topics.length; j++) {
                  if (count >= 10) { break; }
                  addResult(item.Topics[j], resultsDiv);
                  count++;
                }
              } else if (item.Text && item.FirstURL) {
                if (count >= 10) { break; }
                addResult(item, resultsDiv);
                count++;
              }
            }
          }

          if (!data.AbstractText && (!data.RelatedTopics || data.RelatedTopics.length === 0)) {
            resultsDiv.innerHTML = 'No results found.';
          }
        }
      };

      xhr.send();
    }

    function addResult(item, container) {
      var div = document.createElement('div');
      div.className = 'result';
      div.innerHTML =
        '<a href="' + item.FirstURL + '" target="_blank">' + item.Text + '</a>';
      container.appendChild(div);
    }

    function gravitize() {
      var elements = document.body.children;
      for (var i = 0; i < elements.length; i++) {
        var el = elements[i];
        if (el.tagName.toLowerCase() === 'script') continue;

        wrapWithGravity(el);
      }
      animateGravity();
    }

    var boxes = [];

    function wrapWithGravity(el) {
      var box = document.createElement('div');
      box.style.position = 'absolute';
      box.style.cursor = 'grab';
      box.innerHTML = el.outerHTML;
      box.style.left = el.offsetLeft + 'px';
      box.style.top = el.offsetTop + 'px';
      el.style.display = 'none'; // hide original
      document.body.appendChild(box);

      boxes.push({
        el: box,
        x: el.offsetLeft,
        y: el.offsetTop,
        vy: 0
      });
    }

    function animateGravity() {
      var gravity = 0.5;
      var bounce = 0.7;
      var floor = window.innerHeight;

      setInterval(function() {
        for (var i = 0; i < boxes.length; i++) {
          var b = boxes[i];
          b.vy += gravity;
          b.y += b.vy;

          if (b.y + b.el.offsetHeight > floor) {
            b.y = floor - b.el.offsetHeight;
            b.vy *= -bounce;
          }

          b.el.style.top = b.y + 'px';
        }
      }, 20);
    }
  </script>
</body>
</html>
